extend type Query {
    token(id: ID!): Token
    # tokens: Searching is unsupported
    user(id: ID!): User @auth
    users(
        where: UserWhereInput
        orderBy: UserOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [User]! @auth
}

extend type Mutation {
    createToken(
        username: String!
        pass: String!
    ): Token!
    deleteToken(id: ID!): Token
    createUser(
        username: String!
        pass: String!
    ): User! # TODO: CAPTCHA
    updateUser(data: UserUpdateInput!): User @auth
    setUserAdmin(
        id: ID!
        isAdmin: Boolean!
    ): User @auth @admin
    deleteUser(
        id: ID!
    ): User @auth @admin
    uploadAvatar(file: Upload!): File @auth
}

input UserWhereInput {
    id: ID
    username_contains: String
    OR: [UserWhereInput!]
    AND: [UserWhereInput!]
    acceptedProblems_some: ProblemWhereInput
    attemptedProblems_some: ProblemWhereInput
    isAdmin: Boolean
    scopes_some: ScopeWhereInput
    problems_some: ProblemWhereInput
    createdAt_lte: DateTime
    createdAt_gte: DateTime
    updatedAt_lte: DateTime
    updatedAt_gte: DateTime
    lastSubmitAt_lte: DateTime
    lastSubmitAt_gte: DateTime
}

enum UserOrderByInput {
    username_ASC
    username_DESC
    createdAt_ASC
    createdAt_DESC
    updatedAt_ASC
    updatedAt_DESC
    lastSubmitAt_ASC
    lastSubmitAt_DESC
}

input UserUpdateInput {
    username: String
    introduction: String
}

type Token {
    id: ID!
    user: User!
}

type User {
    id: ID!
    username: String!
    introduction: String!
    acceptedProblems(
        scope: ID!
        where: ProblemWhereInput
        orderBy: ProblemOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [Problem!]!
    attemptedProblems(
        scope: ID!
        where: ProblemWhereInput
        orderBy: ProblemOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [Problem!]!
    isAdmin: Boolean!
    scopes(
        where: ScopeWhereInput
        orderBy: ScopeOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [Scope!]!
    participants: [Participant!]!
    submissions(
        scope: ID!
        where: SubmissionWhereInput
        orderBy: SubmissionOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [Submission!]!
    problems(
        scope: ID!
        where: ProblemWhereInput
        orderBy: ProblemOrderByInput
        skip: Int
        first: Int
        last: Int
    ): [Problem!]!
    createdAt: String!
    updatedAt: String!
    lastSubmitAt: String!
}
